<div class="row" id="top-characters" ng-controller="TopCharactersCtrl" ng-cloak>
  <div class="col-md-12">
    <div class="panel panel-danger">

      <div class="panel-heading">
        <h2>
          Top Characters
          <span class="text-muted">by</span>
          {{topCharacters.statsLabel()}}
          <span class="text-muted">in</span>
          {{topCharacters.worldLabel()}}
        </h2>
      </div>

      <div class="panel-body">
        <input class="form-control" style="margin-bottom: 15px" type="text" placeholder="Filter by Character or League Name"
                ng-model="filterModel.value" wd-keydown="filter(filterModel.value)">

        <small>Top</small>

        <div class="btn-group">
          <button class="btn btn-xs btn-default dropdown-toggle" type="button" data-toggle="dropdown">
            {{topCharacters.statsLabel()}} <i class="fa fa-chevron-down"></i>
          </button>

          <ul class="dropdown-menu" role="menu">
            <li><a href="" ng-click="topCharacters.set('stats', 'skill_points')">skill points</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'combat_rating')">PvE CR</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'pvp_combat_rating')">PvP CR</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'max_health')">health</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'max_power')">power</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'defense')">defense</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'dominance')">dominance</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'might')">might</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'precision')">precision</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'restoration')">restoration</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'toughness')">toughness</a></li>
            <li><a href="" ng-click="topCharacters.set('stats', 'vitalization')">vitalization</a></li>
          </ul>
        </div>

        <small>in</small>

        <div class="btn-group">
          <button class="btn btn-xs btn-default dropdown-toggle" type="button" data-toggle="dropdown">
            {{topCharacters.worldLabel()}} <i class="fa fa-chevron-down"></i>
          </button>

          <ul class="dropdown-menu dropdown-menu-right" role="menu">
            <li><a href="" ng-click="topCharacters.set('world', 'usps')">USPS</a></li>
            <li><a href="" ng-click="topCharacters.set('world', 'uspc')">USPC</a></li>
            <li><a href="" ng-click="topCharacters.set('world', 'eups')">EUPS</a></li>
            <li><a href="" ng-click="topCharacters.set('world', 'eupc')">EUPC</a></li>
            <li><a href="" ng-click="topCharacters.set('world', 'all')">all worlds</a></li>
          </ul>
        </div>

        <div class="pull-right">
          <a href="" ng-click="toggle('showImages')" ng-show="showImages"><i class="fa fa-toggle-on"></i> images</a>
          <a href="" ng-click="toggle('showImages')" ng-show="!showImages"><i class="fa fa-toggle-off"></i> images</a>
        </div>

        <hr>

        <h2 ng-if="topCharacters.characters.length === 0">
          <i class="fa fa-spin fa-circle-o-notch"></i> Loading...
        </h2>

        <table class="wd-table">
          <tbody>

            <tr ng-repeat="character in topCharacters.characters | filter:filterModel.parse">

              <td width="1">
                <a ng-href="{{character.path}}">
                  <img class="top-character-thumbnail" ng-src="{{character.image}}" ng-if="showImages"
                    onerror="this.onerror = null; this.src='/placeholder.gif'; return false">
                </a>
              </td>

              <td>
                <!-- <small class="text-muted"># {{character.topRank}}</small> -->

                <h2>
                  <a ng-href="{{character.path}}">
                    <i class="fa fa-chevron-circle-right"></i> {{character.name}}
                  </a>
                </h2>

                <small ng-show="character.league">
                  <a class="text-muted" ng-href="{{character.league.path}}">
                    <i class="fa fa-chevron-circle-right"></i> {{character.league.name}}
                  </a>
                </small>
              </td>

              <td>
                <h2 class="text-right">
                  {{character[topCharacters.statsCamel()] | number}}
                  <small class="text-muted block">{{topCharacters.statsLabel()}}</small>
                </h2>

                <table class="summary pull-right">
                  <tr>
                    <td><small>{{character.pveCr}}</small></td>
                    <td><small>{{character.pvpCr}}</small></td>
                    <td><small>{{character.skillPoints}}</small></td>
                  </tr>

                  <tr>
                    <td><small class="text-muted">PvE</small></td>
                    <td><small class="text-muted">PvP</small></td>
                    <td><small class="text-muted">SP</small></td>
                  </tr>
                </table>

              </td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>
  </div>
</div>
